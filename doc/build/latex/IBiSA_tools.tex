% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}

\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
  \DeclareUnicodeCharacter{00A0}{\nobreakspace}
\else\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}
\usepackage{times}
\usepackage[Bjarne]{fncychap}
\usepackage{longtable}
\usepackage{sphinx}
\usepackage{multirow}
\usepackage{eqparbox}


\addto\captionsenglish{\renewcommand{\figurename}{Fig.\@ }}
\addto\captionsenglish{\renewcommand{\tablename}{Table }}
\SetupFloatingEnvironment{literal-block}{name=Listing }

\addto\extrasenglish{\def\pageautorefname{page}}

\setcounter{tocdepth}{1}


\title{IBiSA\_tools Documentation}
\date{Jun 24, 2016}
\release{0.14}
\author{Kota Kasahara}
\newcommand{\sphinxlogo}{}
\renewcommand{\releasename}{Release}
\makeindex

\makeatletter
\def\PYG@reset{\let\PYG@it=\relax \let\PYG@bf=\relax%
    \let\PYG@ul=\relax \let\PYG@tc=\relax%
    \let\PYG@bc=\relax \let\PYG@ff=\relax}
\def\PYG@tok#1{\csname PYG@tok@#1\endcsname}
\def\PYG@toks#1+{\ifx\relax#1\empty\else%
    \PYG@tok{#1}\expandafter\PYG@toks\fi}
\def\PYG@do#1{\PYG@bc{\PYG@tc{\PYG@ul{%
    \PYG@it{\PYG@bf{\PYG@ff{#1}}}}}}}
\def\PYG#1#2{\PYG@reset\PYG@toks#1+\relax+\PYG@do{#2}}

\expandafter\def\csname PYG@tok@gd\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PYG@tok@gu\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PYG@tok@gt\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PYG@tok@gs\endcsname{\let\PYG@bf=\textbf}
\expandafter\def\csname PYG@tok@gr\endcsname{\def\PYG@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PYG@tok@cm\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@vg\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\expandafter\def\csname PYG@tok@vi\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\expandafter\def\csname PYG@tok@mh\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@cs\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}\def\PYG@bc##1{\setlength{\fboxsep}{0pt}\colorbox[rgb]{1.00,0.94,0.94}{\strut ##1}}}
\expandafter\def\csname PYG@tok@ge\endcsname{\let\PYG@it=\textit}
\expandafter\def\csname PYG@tok@vc\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\expandafter\def\csname PYG@tok@il\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@go\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.20,0.20,0.20}{##1}}}
\expandafter\def\csname PYG@tok@cp\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@gi\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PYG@tok@gh\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PYG@tok@ni\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.84,0.33,0.22}{##1}}}
\expandafter\def\csname PYG@tok@nl\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.13,0.44}{##1}}}
\expandafter\def\csname PYG@tok@nn\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.05,0.52,0.71}{##1}}}
\expandafter\def\csname PYG@tok@no\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.38,0.68,0.84}{##1}}}
\expandafter\def\csname PYG@tok@na\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@nb\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@nc\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.05,0.52,0.71}{##1}}}
\expandafter\def\csname PYG@tok@nd\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.33,0.33,0.33}{##1}}}
\expandafter\def\csname PYG@tok@ne\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@nf\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.02,0.16,0.49}{##1}}}
\expandafter\def\csname PYG@tok@si\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.44,0.63,0.82}{##1}}}
\expandafter\def\csname PYG@tok@s2\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@nt\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.02,0.16,0.45}{##1}}}
\expandafter\def\csname PYG@tok@nv\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\expandafter\def\csname PYG@tok@s1\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@ch\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@m\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@gp\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.78,0.36,0.04}{##1}}}
\expandafter\def\csname PYG@tok@sh\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@ow\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@sx\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.78,0.36,0.04}{##1}}}
\expandafter\def\csname PYG@tok@bp\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@c1\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@o\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PYG@tok@kc\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@c\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@mf\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@err\endcsname{\def\PYG@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PYG@tok@mb\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@ss\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.32,0.47,0.09}{##1}}}
\expandafter\def\csname PYG@tok@sr\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.14,0.33,0.53}{##1}}}
\expandafter\def\csname PYG@tok@mo\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@kd\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@mi\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@kn\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@cpf\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@kr\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@s\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@kp\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@w\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PYG@tok@kt\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.56,0.13,0.00}{##1}}}
\expandafter\def\csname PYG@tok@sc\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@sb\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@k\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@se\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@sd\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}

\def\PYGZbs{\char`\\}
\def\PYGZus{\char`\_}
\def\PYGZob{\char`\{}
\def\PYGZcb{\char`\}}
\def\PYGZca{\char`\^}
\def\PYGZam{\char`\&}
\def\PYGZlt{\char`\<}
\def\PYGZgt{\char`\>}
\def\PYGZsh{\char`\#}
\def\PYGZpc{\char`\%}
\def\PYGZdl{\char`\$}
\def\PYGZhy{\char`\-}
\def\PYGZsq{\char`\'}
\def\PYGZdq{\char`\"}
\def\PYGZti{\char`\~}
% for compatibility with earlier versions
\def\PYGZat{@}
\def\PYGZlb{[}
\def\PYGZrb{]}
\makeatother

\renewcommand\PYGZsq{\textquotesingle}

\begin{document}

\maketitle
\tableofcontents
\phantomsection\label{index::doc}


Contents:


\chapter{About}
\label{about:about}\label{about::doc}\label{about:welcome-to-ibisa-tools-s-documentation}

\section{Authors}
\label{about:authors}
IBiSA\_tools version 0.12 (12 Jun. 2016)
\begin{itemize}
\item {} 
Kota Kasahara, Ritsumeikan University

\item {} 
Kengo Kinoshita, Tohoku University

\end{itemize}


\section{Citation}
\label{about:citation}\begin{itemize}
\item {} 
Kasahara K and Kinoshita K, (Under review) IBiSA\_tools: A Computational Toolkit for the Ion Binding State Analysis on Molecular Dynamics Trajectories of Ion Channels.

\item {} 
Kasahara K, Shirota M, and Kinoshita K (2016) Ion Concentration- and Voltage-Dependent Push and Pull Mechanisms of Potassium Channel Ion Conduction. PLoS ONE, 11, e0150716.

\item {} 
Kasahara K, Shirota M, and Kinoshita K (2013) Ion Concentration-Dependent Ion Conduction Mechanism of a Voltage-Sensitive Potassium Channel. PLoS ONE, 8, e56342.

\end{itemize}


\section{Overview}
\label{about:overview}
IBiSA\_tools, which stands for ``Ion Binding State Analysis tools'', provides a computational tools for analyzing ion conduction mechanisms hidden in the molecular dynamics (MD) trajectory data. In this analysis, each ion conduction event is detected and mechanisms of the events are identified. See the citations for details of theory and applications.
\begin{itemize}
\item {} 
The current version of IBiSA\_tools can be applied only for GROMACS trajectory file (.trr). If your trajectories are written in another format, you have to convert it into .trr, by using some tools, e.g., VMD plugin and MDAnalysis.

\item {} 
IBiSA\_tools is consisting of a C++ program and Python (2.6 or 2.7) scripts.

\item {} 
The attached tutorial files use R software (www.r-project.org) to draw plots.

\item {} 
Network drawing software, e.g., Cytoscape, is required to visualize ion binding state graph.

\end{itemize}

\url{http://kotakasahara.github.com}

Only a C++ program, trachan, must be compiled as follows:

\begin{Verbatim}[commandchars=\\\{\}]
\PYG{n}{cd} \PYG{n}{src}\PYG{o}{/}\PYG{n}{trachan}
\PYG{o}{.}\PYG{o}{/}\PYG{n}{configure}
\PYG{n}{make}
\end{Verbatim}

In this document, we assume the binary and python scripts are included at the directory indicated by \$\{IBISA\}.


\chapter{Tutorial}
\label{tutorial::doc}\label{tutorial:tutorial}

\section{Setting the path to IBiSA\_tools}
\label{tutorial:setting-the-path-to-ibisa-tools}
\begin{Verbatim}[commandchars=\\\{\}]
\PYG{n}{export} \PYG{n}{IBISA}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdl{}}\PYG{l+s+si}{\PYGZob{}HOME\PYGZcb{}}\PYG{l+s+s2}{/local/ibisa}\PYG{l+s+s2}{\PYGZdq{}}
\end{Verbatim}

Set your own install directory.


\section{Preparing the configuration file}
\label{tutorial:preparing-the-configuration-file}
config.txt:

\begin{Verbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{fn}\PYG{o}{\PYGZhy{}}\PYG{n}{pdb}                      \PYG{n}{init}\PYG{o}{.}\PYG{n}{pdb}
\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{dt}                          \PYG{l+m+mi}{10}
\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{site}\PYG{o}{\PYGZhy{}}\PYG{n}{boundary}               \PYG{l+m+mf}{20.0}
\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{site}\PYG{o}{\PYGZhy{}}\PYG{n}{boundary}              \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{25.0}
\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{fn}\PYG{o}{\PYGZhy{}}\PYG{n}{pore}\PYG{o}{\PYGZhy{}}\PYG{n}{axis}\PYG{o}{\PYGZhy{}}\PYG{n}{coordinates}    \PYG{n}{pore\PYGZus{}axis}\PYG{o}{.}\PYG{n}{txt}
\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{fn}\PYG{o}{\PYGZhy{}}\PYG{n}{pore}\PYG{o}{\PYGZhy{}}\PYG{n}{axis}\PYG{o}{\PYGZhy{}}\PYG{n}{coordinates}\PYG{o}{\PYGZhy{}}\PYG{n}{r}  \PYG{n}{pore\PYGZus{}axis\PYGZus{}r}\PYG{o}{.}\PYG{n}{txt}
\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{pore}\PYG{o}{\PYGZhy{}}\PYG{n}{axis}\PYG{o}{\PYGZhy{}}\PYG{n}{basis}\PYG{o}{\PYGZhy{}}\PYG{k+kn}{from}        \PYG{n+nn}{A} \PYG{l+m+mi}{374} \PYG{n}{O}
\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{pore}\PYG{o}{\PYGZhy{}}\PYG{n}{axis}\PYG{o}{\PYGZhy{}}\PYG{n}{basis}\PYG{o}{\PYGZhy{}}\PYG{k+kn}{from}        \PYG{n+nn}{B} \PYG{l+m+mi}{374} \PYG{n}{O}
\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{pore}\PYG{o}{\PYGZhy{}}\PYG{n}{axis}\PYG{o}{\PYGZhy{}}\PYG{n}{basis}\PYG{o}{\PYGZhy{}}\PYG{k+kn}{from}        \PYG{n+nn}{C} \PYG{l+m+mi}{374} \PYG{n}{O}
\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{pore}\PYG{o}{\PYGZhy{}}\PYG{n}{axis}\PYG{o}{\PYGZhy{}}\PYG{n}{basis}\PYG{o}{\PYGZhy{}}\PYG{k+kn}{from}        \PYG{n+nn}{D} \PYG{l+m+mi}{374} \PYG{n}{O}
\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{pore}\PYG{o}{\PYGZhy{}}\PYG{n}{axis}\PYG{o}{\PYGZhy{}}\PYG{n}{basis}\PYG{o}{\PYGZhy{}}\PYG{n}{to}          \PYG{n}{A} \PYG{l+m+mi}{377} \PYG{n}{O}
\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{pore}\PYG{o}{\PYGZhy{}}\PYG{n}{axis}\PYG{o}{\PYGZhy{}}\PYG{n}{basis}\PYG{o}{\PYGZhy{}}\PYG{n}{to}          \PYG{n}{B} \PYG{l+m+mi}{377} \PYG{n}{O}
\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{pore}\PYG{o}{\PYGZhy{}}\PYG{n}{axis}\PYG{o}{\PYGZhy{}}\PYG{n}{basis}\PYG{o}{\PYGZhy{}}\PYG{n}{to}          \PYG{n}{C} \PYG{l+m+mi}{377} \PYG{n}{O}
\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{pore}\PYG{o}{\PYGZhy{}}\PYG{n}{axis}\PYG{o}{\PYGZhy{}}\PYG{n}{basis}\PYG{o}{\PYGZhy{}}\PYG{n}{to}          \PYG{n}{D} \PYG{l+m+mi}{377} \PYG{n}{O}
\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{site}\PYG{o}{\PYGZhy{}}\PYG{n+nb}{max}\PYG{o}{\PYGZhy{}}\PYG{n}{radius}           \PYG{l+m+mf}{10.0}
\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{site}\PYG{o}{\PYGZhy{}}\PYG{n}{height}\PYG{o}{\PYGZhy{}}\PYG{n}{margin}         \PYG{l+m+mf}{5.0}
\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{channel}\PYG{o}{\PYGZhy{}}\PYG{n}{chain}\PYG{o}{\PYGZhy{}}\PYG{n+nb}{id}          \PYG{n}{ABCD}
\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{trace}\PYG{o}{\PYGZhy{}}\PYG{n}{atom}\PYG{o}{\PYGZhy{}}\PYG{n}{name}           \PYG{n}{K}
\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{fn}\PYG{o}{\PYGZhy{}}\PYG{n}{trr} \PYG{n}{traj}\PYG{o}{.}\PYG{n}{trr}
\end{Verbatim}

Each line indicate a set of key and values.
\begin{itemize}
\item {} 
\emph{--mode} is always ``sice-occupancy''. This field is for future extensions.

\item {} 
\emph{--fn-pdb} is the initial structure file.

\item {} 
\emph{--dt} is the delta-t for the trajectory file

\item {} 
\emph{--site-max-radius} is the maximum radius of ion channel pore.

\item {} 
\emph{--site-boundary} is specified two values, 20.0 and -25.0. This setting means that the range from 20.0 \textgreater{} z \textgreater{} -25.0 in the pore axis will be analyzed. The origin is set by \emph{--pore-axis-basis-from} key.

\item {} 
\emph{--fn-pore-axis-coordinates} and \emph{--fn-pore-axis-coordinates-r} are the output filenames.

\item {} 
\emph{--pore-axis-basis-from} specifies the origin of the pore axis. ``A 374 O'' means the O atom in the residue 374 of the chain A. In this tutorial, four oxigen atoms are specified. The center of these atoms is set to be the origin of the pore axis.

\item {} 
\emph{--pore-axis-basis-to} is the direction of the pore axis. The line from the center of \emph{...-from} to the center of \emph{...-to} defines the pore axis.

\item {} 
\emph{--site-height-margin} is the margin length along the pore axis. In this case, the range from 20.0+5.0 to -25.0-5.0 will be analyzed.

\item {} 
\emph{--channel-chain-id} specifies chain ids of a channel protein.

\item {} 
\emph{--trace-atom-name} specifies the atom name of target ions, defined in the .pdb file.

\item {} 
\emph{--fn-trr} is the file name of the trajectory.

\end{itemize}


\section{Executing ``trachan''}
\label{tutorial:executing-trachan}
\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdl{}IBISA/bin/trachan \PYGZhy{}\PYGZhy{}fn\PYGZhy{}cfg config.txt
\end{Verbatim}

Some text should appear in the standard output:

\begin{Verbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}
                      \PYG{n}{TraChan}
  \PYG{n}{TRAjectory} \PYG{n}{analyzer} \PYG{k}{for} \PYG{n}{CHANnel} \PYG{n}{pore} \PYG{n}{axis}
\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}
\PYG{n}{Copyright} \PYG{p}{(}\PYG{n}{c}\PYG{p}{)} \PYG{l+m+mi}{2016} \PYG{n}{Kota} \PYG{n}{Kasahara}\PYG{p}{,} \PYG{n}{Ritsumeikan} \PYG{n}{University}
\PYG{n}{This} \PYG{n}{software} \PYG{o+ow}{is} \PYG{n}{distributed} \PYG{n}{under} \PYG{n}{the} \PYG{n}{terms} \PYG{n}{of} \PYG{n}{the} \PYG{n}{GPL} \PYG{n}{license}

\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}
\PYG{n}{This} \PYG{n}{program} \PYG{o+ow}{is} \PYG{n}{contains} \PYG{n}{some} \PYG{n}{parts} \PYG{n}{of} \PYG{n}{the} \PYG{n}{source} \PYG{n}{code} \PYG{n}{of} \PYG{n}{GROMACS}
\PYG{n}{software}\PYG{o}{.} \PYG{n}{Check} \PYG{n}{out} \PYG{n}{http}\PYG{p}{:}\PYG{o}{/}\PYG{o}{/}\PYG{n}{www}\PYG{o}{.}\PYG{n}{gromacs}\PYG{o}{.}\PYG{n}{org} \PYG{n}{about} \PYG{n}{GROMACS}\PYG{o}{.}
\PYG{n}{Copyright} \PYG{p}{(}\PYG{n}{c}\PYG{p}{)} \PYG{l+m+mi}{1991}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2000}\PYG{p}{,} \PYG{n}{University} \PYG{n}{of} \PYG{n}{Groningen}\PYG{p}{,} \PYG{n}{The} \PYG{n}{Netherlands}
\PYG{n}{Copyright} \PYG{p}{(}\PYG{n}{c}\PYG{p}{)} \PYG{l+m+mi}{2001}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2010}\PYG{p}{,} \PYG{n}{The} \PYG{n}{GROMACS} \PYG{n}{development} \PYG{n}{team} \PYG{n}{at}
\PYG{n}{Uppsala} \PYG{n}{University} \PYG{o}{\PYGZam{}} \PYG{n}{The} \PYG{n}{Royal} \PYG{n}{Institute} \PYG{n}{of} \PYG{n}{Technology}\PYG{p}{,} \PYG{n}{Sweden}\PYG{o}{.}
\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}
\PYG{n}{TraChan}\PYG{p}{:}\PYG{p}{:}\PYG{n}{mainRoutine}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{site} \PYG{n}{occupancy} \PYG{n}{mode}
\PYG{n}{n\PYGZus{}atoms} \PYG{p}{:} \PYG{l+m+mi}{6997}
\PYG{n}{pore} \PYG{n}{axis} \PYG{n}{basis} \PYG{n}{a}
\PYG{l+m+mi}{1014} \PYG{n}{O} \PYG{n}{THR} \PYG{l+m+mi}{374}
\PYG{l+m+mi}{2735} \PYG{n}{O} \PYG{n}{THR} \PYG{l+m+mi}{374}
\PYG{l+m+mi}{4456} \PYG{n}{O} \PYG{n}{THR} \PYG{l+m+mi}{374}
\PYG{l+m+mi}{6177} \PYG{n}{O} \PYG{n}{THR} \PYG{l+m+mi}{374}
\PYG{n}{pore} \PYG{n}{axis} \PYG{n}{basis} \PYG{n}{b}
\PYG{l+m+mi}{1058} \PYG{n}{O} \PYG{n}{TYR} \PYG{l+m+mi}{377}
\PYG{l+m+mi}{2779} \PYG{n}{O} \PYG{n}{TYR} \PYG{l+m+mi}{377}
\PYG{l+m+mi}{4500} \PYG{n}{O} \PYG{n}{TYR} \PYG{l+m+mi}{377}
\PYG{l+m+mi}{6221} \PYG{n}{O} \PYG{n}{TYR} \PYG{l+m+mi}{377}
\PYG{n+nb}{open} \PYG{n}{pore\PYGZus{}axis}\PYG{o}{.}\PYG{n}{txt}
\PYG{n+nb}{open} \PYG{n}{pore\PYGZus{}axis\PYGZus{}r}\PYG{o}{.}\PYG{n}{txt}
\PYG{n}{average} \PYG{n}{axis} \PYG{n}{length} \PYG{o}{=} \PYG{l+m+mf}{0.945331}
\PYG{n}{sd} \PYG{n}{axis} \PYG{n}{length} \PYG{o}{=} \PYG{l+m+mf}{0.000977426}
\end{Verbatim}

And the two output files, \emph{pore\_axis.txt} and \emph{pore\_axis\_r.txt} will be obtained.

They are tab-separated text. The first column indicate the time, and the other columns correspond to each potassium ion. Each row indicates the position of each ion at the time. \emph{pore\_axis.txt} and \emph{pore\_axis\_r.txt} record the coordinates along the pore axis and those along the radial direction parpendicular to the pore axis.
\begin{quote}
\begin{description}
\item[{python \$IBISA/bin/detect\_ion\_permeation.py }] \leavevmode
--i-pore-crd-h pore\_axis.txt --i-pore-crd-r pore\_axis\_r.txt --o-permeation-event permeation\_event.txt --atom K --b-r 10 --b-h-up 20 --b-h-low -25

\end{description}

Trace each potassium ion travelling from -25 to 20 in z-axis. This script does not consider whether the ion through inside the pore or not.
The output file \emph{permeation\_event.txt}:

6961    K       -       +       5950    21400
6986    K       -       +       10370   30830
6974    K       -       +       11010   38810
6953    K       -       +       28720   44950
6968    K       -       +       36780   47280
6961    K       -       +       39150   48360

The first column is the ID of ion, the symbols \emph{-} and \emph{+} means that the ion permeated from the \emph{-} side to the \emph{+} side. The last two columns indicate times when the ion enters and goes out the defined region.
\end{quote}


\section{Drawing the trajectory of ions along the pore axis}
\label{tutorial:drawing-the-trajectory-of-ions-along-the-pore-axis}
\begin{Verbatim}[commandchars=\\\{\}]
R \PYGZhy{}\PYGZhy{}vanilla \PYGZhy{}\PYGZhy{}slave \PYGZlt{} \PYGZdl{}IBISA/r/pore\PYGZus{}axis\PYGZus{}traj.R
\end{Verbatim}

\emph{pore\_axis\_traj.eps} shows the time course of ion coordinates.

\includegraphics[width=10cm]{{pore_axis_traj}.png}


\section{Analyzing the histogram of ions}
\label{tutorial:analyzing-the-histogram-of-ions}
Histogram of ion frequency over the 2D pore axis space can be drawn by:

\begin{Verbatim}[commandchars=\\\{\}]
python \PYGZdl{}IBISA/bin/ion\PYGZus{}histogram.py \PYGZbs{}
  \PYGZhy{}\PYGZhy{}i\PYGZhy{}pore\PYGZhy{}crd\PYGZhy{}h pore\PYGZus{}axis.txt \PYGZbs{}
  \PYGZhy{}\PYGZhy{}i\PYGZhy{}pore\PYGZhy{}crd\PYGZhy{}r pore\PYGZus{}axis\PYGZus{}r.txt \PYGZbs{}
  \PYGZhy{}\PYGZhy{}o\PYGZhy{}histogram histogram.txt \PYGZbs{}
  \PYGZhy{}\PYGZhy{}atomname K


  R \PYGZhy{}\PYGZhy{}vanilla \PYGZhy{}\PYGZhy{}slave \PYGZlt{} \PYGZdl{}IBISA/r/histogram.R
\end{Verbatim}

\emph{histogram.eps} is the 1D and 2D histogram of ions.


\section{Analyzing the density distribution of ions along the pore axis}
\label{tutorial:analyzing-the-density-distribution-of-ions-along-the-pore-axis}
\begin{Verbatim}[commandchars=\\\{\}]
R \PYGZhy{}\PYGZhy{}vanilla \PYGZhy{}\PYGZhy{}slave \PYGZlt{} \PYGZdl{}IBISA/r/pore\PYGZus{}axis\PYGZus{}density.R
\end{Verbatim}

\emph{density\_distribution.eps} is the distribution plot.

\includegraphics[width=10cm]{{distribution}.png}

This plot clearly shows localization of ions in the ion binding sites. On the basis of this plot, we can define the boundary of each ion binding site.

Here, we use the definition which is defined in our previous paper. The boundaries of ion binding sites are  15.13, 12.93, 9.32, 6.25, 3.00, 0.44, -2.21, -6.08, and -20.


\section{Discretizing the trajectory based on ion-binding sites}
\label{tutorial:discretizing-the-trajectory-based-on-ion-binding-sites}
\begin{Verbatim}[commandchars=\\\{\}]
python \PYGZdl{}IBISA/bin/site\PYGZus{}occupancy.py \PYGZbs{}
 \PYGZhy{}\PYGZhy{}i\PYGZhy{}pore\PYGZhy{}crd\PYGZhy{}h pore\PYGZus{}axis.txt \PYGZbs{}
 \PYGZhy{}\PYGZhy{}i\PYGZhy{}pore\PYGZhy{}crd\PYGZhy{}r pore\PYGZus{}axis\PYGZus{}r.txt \PYGZbs{}
  \PYGZhy{}\PYGZhy{}o\PYGZhy{}site\PYGZhy{}occ   site\PYGZus{}occ.txt \PYGZbs{}
  \PYGZhy{}\PYGZhy{}atomname K \PYGZbs{}
  \PYGZhy{}b 12.93 \PYGZhy{}b 9.32 \PYGZhy{}b 6.25 \PYGZhy{}b 3.00 \PYGZhy{}b 0.44 \PYGZhy{}b \PYGZhy{}2.21 \PYGZhy{}b \PYGZhy{}6.08  \PYGZhy{}b \PYGZhy{}20 \PYGZbs{}
  \PYGZhy{}n \PYGZsq{}\PYGZhy{}1\PYGZsq{}  \PYGZhy{}n 0     \PYGZhy{}n 1    \PYGZhy{}n 2    \PYGZhy{}n 3    \PYGZhy{}n 4    \PYGZhy{}n 5     \PYGZhy{}n 6
\end{Verbatim}

The output file \emph{site\_occ.txt} records information about what ions are retained in each ion binding sites in each snapshot.

site\_ooc.txt:

\begin{Verbatim}[commandchars=\\\{\}]
\PYG{l+m+mi}{0}       \PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{6946}\PYG{p}{:}\PYG{n}{K}        \PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{6985}\PYG{p}{:}\PYG{n}{K}        \PYG{l+m+mi}{4}\PYG{p}{:}\PYG{l+m+mi}{6993}\PYG{p}{:}\PYG{n}{K}        \PYG{l+m+mi}{6}\PYG{p}{:}\PYG{l+m+mi}{6935}\PYG{p}{:}\PYG{n}{K}
\PYG{l+m+mi}{10}      \PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{6946}\PYG{p}{:}\PYG{n}{K}        \PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{6985}\PYG{p}{:}\PYG{n}{K}        \PYG{l+m+mi}{4}\PYG{p}{:}\PYG{l+m+mi}{6993}\PYG{p}{:}\PYG{n}{K}        \PYG{l+m+mi}{6}\PYG{p}{:}\PYG{l+m+mi}{6935}\PYG{p}{:}\PYG{n}{K}
\PYG{l+m+mi}{20}      \PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{6946}\PYG{p}{:}\PYG{n}{K}        \PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{6985}\PYG{p}{:}\PYG{n}{K}        \PYG{l+m+mi}{4}\PYG{p}{:}\PYG{l+m+mi}{6993}\PYG{p}{:}\PYG{n}{K}        \PYG{l+m+mi}{6}\PYG{p}{:}\PYG{l+m+mi}{6935}\PYG{p}{:}\PYG{n}{K}
\PYG{l+m+mi}{30}      \PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{6946}\PYG{p}{:}\PYG{n}{K}        \PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{6985}\PYG{p}{:}\PYG{n}{K}        \PYG{l+m+mi}{4}\PYG{p}{:}\PYG{l+m+mi}{6993}\PYG{p}{:}\PYG{n}{K}        \PYG{l+m+mi}{6}\PYG{p}{:}\PYG{l+m+mi}{6935}\PYG{p}{:}\PYG{n}{K}
\PYG{l+m+mi}{40}      \PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{6946}\PYG{p}{:}\PYG{n}{K}        \PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{6985}\PYG{p}{:}\PYG{n}{K}        \PYG{l+m+mi}{4}\PYG{p}{:}\PYG{l+m+mi}{6993}\PYG{p}{:}\PYG{n}{K}        \PYG{l+m+mi}{6}\PYG{p}{:}\PYG{l+m+mi}{6935}\PYG{p}{:}\PYG{n}{K}
\end{Verbatim}

``1:6956:K'' means the ion K with the ID 6946 is bound at the site 1.


\section{Analyzing the trajectories of each ion}
\label{tutorial:analyzing-the-trajectories-of-each-ion}
\begin{Verbatim}[commandchars=\\\{\}]
python \PYGZdl{}\PYGZob{}IBISA\PYGZcb{}/bin/analyze\PYGZus{}ion\PYGZus{}path.py \PYGZbs{}
  \PYGZhy{}\PYGZhy{}i\PYGZhy{}site\PYGZhy{}occ        site\PYGZus{}occ.txt \PYGZbs{}
  \PYGZhy{}\PYGZhy{}o\PYGZhy{}all\PYGZhy{}path        site\PYGZus{}path.txt \PYGZbs{}
  \PYGZhy{}\PYGZhy{}o\PYGZhy{}count\PYGZhy{}full      site\PYGZus{}path\PYGZus{}count\PYGZus{}full.txt \PYGZbs{}
  \PYGZhy{}\PYGZhy{}o\PYGZhy{}count\PYGZhy{}head\PYGZhy{}tail site\PYGZus{}path\PYGZus{}count\PYGZus{}ht.txt
\end{Verbatim}

The output \emph{site\_path.txt}:

\begin{Verbatim}[commandchars=\\\{\}]
\PYG{l+m+mi}{6985}    \PYG{n}{K}       \PYG{o}{*}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{o}{*} \PYG{l+m+mi}{0}\PYG{p}{:}\PYG{l+m+mi}{7250}  \PYG{o}{*}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{o}{*}     \PYG{l+m+mi}{0}\PYG{p}{:}\PYG{l+m+mi}{5290}\PYG{p}{:}\PYG{l+m+mi}{5340}\PYG{p}{:}\PYG{l+m+mi}{7240}\PYG{p}{:}\PYG{l+m+mi}{7250}
\PYG{l+m+mi}{6985}    \PYG{n}{K}       \PYG{o}{*}\PYG{p}{:}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{o}{*}   \PYG{l+m+mi}{7320}\PYG{p}{:}\PYG{l+m+mi}{7350}       \PYG{o}{*}\PYG{p}{:}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{o}{*}   \PYG{l+m+mi}{7320}\PYG{p}{:}\PYG{l+m+mi}{7350}
\PYG{l+m+mi}{6985}    \PYG{n}{K}       \PYG{o}{*}\PYG{p}{:}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{o}{*}   \PYG{l+m+mi}{7540}\PYG{p}{:}\PYG{l+m+mi}{7570}       \PYG{o}{*}\PYG{p}{:}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{o}{*}   \PYG{l+m+mi}{7540}\PYG{p}{:}\PYG{l+m+mi}{7570}
\end{Verbatim}

The first column indicates the ID of the ion.
\begin{itemize}
\item {} 
At the third column, ``\emph{:3:0:}'' means this ion got into the pore at site 3, and went out from the site 0.

\item {} 
The fourth column denote the times for getting into and going out from the pore.

\item {} 
The fifth column, ``\emph{:3:2:1:0:}'' indicates the full trajectory of this ion from association the to pore and dissociation from the pore.

\end{itemize}


\section{Generating the ion-binding state graph::}
\label{tutorial:generating-the-ion-binding-state-graph}
\begin{Verbatim}[commandchars=\\\{\}]
python \PYGZdl{}IBISA/bin/analyze\PYGZus{}site\PYGZus{}state.py \PYGZbs{}
  \PYGZhy{}\PYGZhy{}i\PYGZhy{}site\PYGZhy{}occ site\PYGZus{}occ.txt \PYGZbs{}
  \PYGZhy{}\PYGZhy{}o\PYGZhy{}states   state\PYGZus{}traj.txt \PYGZbs{}
  \PYGZhy{}\PYGZhy{}o\PYGZhy{}graph    state\PYGZus{}graph.gml \PYGZbs{}
  \PYGZhy{}\PYGZhy{}atomname   K
\end{Verbatim}

The ion binding state graph can be visualized by using the output file \emph{state\_graph.gml} with a network analysis software, e.g., Cytoscape.

\includegraphics[width=10cm]{{network}.png}

\emph{state\_traj.txt} records the ion binding state in each snapshot:

\begin{Verbatim}[commandchars=\\\{\}]
\PYG{l+m+mi}{0}       \PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{l+m+mi}{6}       \PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{6946}\PYG{p}{:}\PYG{l+m+mi}{6985}\PYG{p}{:}\PYG{l+m+mi}{6993}\PYG{p}{:}\PYG{l+m+mi}{6935}
\PYG{l+m+mi}{10}      \PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{l+m+mi}{6}       \PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{6946}\PYG{p}{:}\PYG{l+m+mi}{6985}\PYG{p}{:}\PYG{l+m+mi}{6993}\PYG{p}{:}\PYG{l+m+mi}{6935}
\PYG{l+m+mi}{20}      \PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{l+m+mi}{6}       \PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{6946}\PYG{p}{:}\PYG{l+m+mi}{6985}\PYG{p}{:}\PYG{l+m+mi}{6993}\PYG{p}{:}\PYG{l+m+mi}{6935}
\PYG{l+m+mi}{30}      \PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{l+m+mi}{6}       \PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{6946}\PYG{p}{:}\PYG{l+m+mi}{6985}\PYG{p}{:}\PYG{l+m+mi}{6993}\PYG{p}{:}\PYG{l+m+mi}{6935}
\end{Verbatim}

The third column indicate the IDs of ions in the ion binding sites.


\section{Extracting cyclic paths from the state trajectory::}
\label{tutorial:extracting-cyclic-paths-from-the-state-trajectory}
\begin{Verbatim}[commandchars=\\\{\}]
python \PYGZdl{}IBISA/bin/extract\PYGZus{}cycles.py \PYGZbs{}
  \PYGZhy{}\PYGZhy{}i\PYGZhy{}state  state\PYGZus{}traj.txt \PYGZbs{}
  \PYGZhy{}\PYGZhy{}o\PYGZhy{}cycles state\PYGZus{}traj\PYGZus{}cycles.txt \PYGZbs{}
  \PYGZhy{}\PYGZhy{}o\PYGZhy{}state\PYGZhy{}dict state\PYGZus{}dict\PYGZus{}pre.txt \PYGZbs{}
  \PYGZhy{}\PYGZhy{}title    \PYGZdq{}sample\PYGZdq{}
\end{Verbatim}
\begin{itemize}
\item {} 
option \emph{--title} is an arbitrary string.

\end{itemize}

\emph{state\_traj\_cycles.txt} stores the cyclic paths:

\begin{Verbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZgt{}}       \PYG{l+m+mi}{1}       \PYG{l+m+mi}{6010}    \PYG{l+m+mi}{7830}    \PYG{n}{sample}
\PYG{l+m+mi}{6010}    \PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{4} \PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{6985}\PYG{p}{:}\PYG{l+m+mi}{6993}\PYG{p}{:}\PYG{l+m+mi}{6935}
\PYG{l+m+mi}{6630}    \PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{l+m+mi}{6}       \PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{6985}\PYG{p}{:}\PYG{l+m+mi}{6993}\PYG{p}{:}\PYG{l+m+mi}{6935}\PYG{p}{:}\PYG{l+m+mi}{6961}
\PYG{l+m+mi}{7190}    \PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{l+m+mi}{5}       \PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{6985}\PYG{p}{:}\PYG{l+m+mi}{6993}\PYG{p}{:}\PYG{l+m+mi}{6935}\PYG{p}{:}\PYG{l+m+mi}{6961}
\PYG{l+m+mi}{7230}    \PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{5}       \PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{6985}\PYG{p}{:}\PYG{l+m+mi}{6993}\PYG{p}{:}\PYG{l+m+mi}{6935}\PYG{p}{:}\PYG{l+m+mi}{6961}
\PYG{l+m+mi}{7820}    \PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{5} \PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{6993}\PYG{p}{:}\PYG{l+m+mi}{6935}\PYG{p}{:}\PYG{l+m+mi}{6961}
\PYG{l+m+mi}{7830}    \PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{4} \PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{6993}\PYG{p}{:}\PYG{l+m+mi}{6935}\PYG{p}{:}\PYG{l+m+mi}{6961}
\end{Verbatim}
\begin{itemize}
\item {} 
The line begining with ``\textgreater{}'' is the header line. The cyclic phat ``1'' starts at 6010 and ends at 7830.

\item {} 
The resting state, K:0:2:4, is the most stable state in the trajectory.

\end{itemize}


\section{Converting states into characters. A cyclic parts transformed into a sequence::}
\label{tutorial:converting-states-into-characters-a-cyclic-parts-transformed-into-a-sequence}
\begin{Verbatim}[commandchars=\\\{\}]
python \PYGZdl{}IBISA/bin/cycle\PYGZus{}to\PYGZus{}sequence.py \PYGZbs{}
  \PYGZhy{}\PYGZhy{}i\PYGZhy{}cycles     state\PYGZus{}traj\PYGZus{}cycles.txt \PYGZbs{}
  \PYGZhy{}\PYGZhy{}i\PYGZhy{}state\PYGZhy{}dict state\PYGZus{}dict\PYGZus{}pre.txt \PYGZbs{}
  \PYGZhy{}\PYGZhy{}o\PYGZhy{}state\PYGZhy{}dict state\PYGZus{}dict.txt \PYGZbs{}
  \PYGZhy{}\PYGZhy{}o\PYGZhy{}sequence   sequences.fsa
\end{Verbatim}
\begin{itemize}
\item {} 
\emph{state\_dict.txt} describes the correspondence between a state and a character.

\item {} 
\emph{sequences.fsa} is the sequences of cyclic paths.:

\begin{Verbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{0}     \PYG{l+m+mi}{0}       \PYG{o}{*}\PYG{n}{POMFB}\PYG{o}{*} \PYG{l+m+mi}{5}       \PYG{l+m+mi}{28990}   \PYG{l+m+mi}{31650}   \PYG{n}{sample}
\end{Verbatim}

\emph{POMFB}
\textgreater{} 1     0       \emph{POMFE} 8       44310   45210   sample
\emph{POMFE}
\textgreater{} 2     0       \emph{PJHF}  7       39280   42200   sample
\emph{PJHF}
\textgreater{} 3     0       \emph{POKLF} 6       36850   38640   sample
\emph{POKLF}

\end{itemize}

Assignment characters can be modified by your self. For clarity, the characters for the ion binding states with 4 ions are replaced with lower cases, and 5-ion state is ``\#''.

vi state\_dict.txt:

\begin{Verbatim}[commandchars=\\\{\}]
\PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{6} \PYG{n}{I}
\PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{l+m+mi}{6} \PYG{n}{J}
\PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{5}       \PYG{n}{k}
\PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{6}       \PYG{n}{l}
\PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{5}       \PYG{n}{m}
\PYG{o}{.}\PYG{o}{.}
\PYG{n}{K}\PYG{p}{:}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{5}\PYG{p}{:}\PYG{l+m+mi}{6}     \PYG{c+c1}{\PYGZsh{}}
\end{Verbatim}

Then, re-do \emph{cycle\_to\_sequence.py}
\begin{quote}
\begin{description}
\item[{python \$IBISA/bin/cycle\_to\_sequence.py }] \leavevmode\begin{optionlist}{3cm}
\item [-{-}i-cycles]  
state\_traj\_cycles.txt 
\end{optionlist}

--i-state-dict state\_dict.txt --o-sequence   sequences.fsa

\end{description}
\end{quote}


\section{Generating score matrix of states}
\label{tutorial:generating-score-matrix-of-states}
\begin{Verbatim}[commandchars=\\\{\}]
python \PYGZdl{}IBISA/bin/make\PYGZus{}score\PYGZus{}matrix.py \PYGZbs{}
   \PYGZhy{}\PYGZhy{}i\PYGZhy{}state\PYGZhy{}dict  state\PYGZus{}dict.txt \PYGZbs{}
   \PYGZhy{}\PYGZhy{}o\PYGZhy{}score       score\PYGZus{}matrix.txt
\end{Verbatim}

The similarity between states are simply defined by the number of binding ions. When the two states have the same number of ions, the score is 0.5. Otherwise, teh score is 0.0.


\section{Performing the sequence alignment}
\label{tutorial:performing-the-sequence-alignment}
\begin{Verbatim}[commandchars=\\\{\}]
python \PYGZdl{}IBISA/bin/dp\PYGZus{}align.py \PYGZbs{}
   \PYGZhy{}\PYGZhy{}i\PYGZhy{}score\PYGZhy{}matrix score\PYGZus{}matrix.txt \PYGZbs{}
   \PYGZhy{}\PYGZhy{}i\PYGZhy{}sequence     sequences.fsa \PYGZbs{}
   \PYGZhy{}\PYGZhy{}o\PYGZhy{}align        align.txt \PYGZhy{}a\PYGZbs{}
   \PYGZhy{}\PYGZhy{}min\PYGZhy{}len   4 \PYGZbs{}
   \PYGZhy{}g 1.0 \PYGZbs{}
   \PYGZhy{}m 1.0 \PYGZbs{}
   \PYGZhy{}\PYGZhy{}ignore *
\end{Verbatim}
\begin{itemize}
\item {} 
\emph{-g} and \emph{-m} are gap score and match score, respectively.

\item {} 
The output file \emph{align.txt} shows the pairwise alignments:

\begin{Verbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{2}     \PYG{l+m+mi}{3}       \PYG{l+m+mf}{0.0}     \PYG{l+m+mi}{2}       \PYG{l+m+mi}{0}       \PYG{o}{*}\PYG{n}{pJHF}\PYG{o}{*}  \PYG{l+m+mi}{7}       \PYG{l+m+mi}{39280}   \PYG{l+m+mi}{42200}   \PYG{n}{sample}  \PYG{l+m+mi}{3}       \PYG{l+m+mi}{0}       \PYG{o}{*}\PYG{n}{poklF}\PYG{o}{*} \PYG{l+m+mi}{6}       \PYG{l+m+mi}{36850}   \PYG{l+m+mi}{38640}   \PYG{n}{sample}
\end{Verbatim}

\emph{pJH-F}
\emph{poklF}
\textgreater{} 0     3       1.0     0       0       \emph{pomFB} 5       28990   31650   sample  3       0       \emph{poklF} 6       36850   38640   sample
\emph{pom-FB}
\emph{poklF-}

\end{itemize}


\section{Make the similarity matrix of cyclic paths}
\label{tutorial:make-the-similarity-matrix-of-cyclic-paths}
\begin{Verbatim}[commandchars=\\\{\}]
python \PYGZdl{}IBISA/bin/align\PYGZus{}similarity.py \PYGZbs{}
  \PYGZhy{}\PYGZhy{}i\PYGZhy{}align     align.txt \PYGZbs{}
  \PYGZhy{}\PYGZhy{}i\PYGZhy{}sequence  sequences.fsa \PYGZbs{}
  \PYGZhy{}\PYGZhy{}o\PYGZhy{}sim       align\PYGZus{}sim.txt \PYGZbs{}
  \PYGZhy{}g 1 \PYGZhy{}m 1
\end{Verbatim}


\section{Clustering aligned sequences by using R}
\label{tutorial:clustering-aligned-sequences-by-using-r}
\begin{Verbatim}[commandchars=\\\{\}]
R \PYGZhy{}\PYGZhy{}vanilla \PYGZhy{}\PYGZhy{}slave \PYGZlt{} \PYGZdl{}IBISA/r/clustering\PYGZus{}seq.R
\end{Verbatim}

\includegraphics[width=10cm]{{dendrogram}.png}


\chapter{Indices and tables}
\label{index:indices-and-tables}\begin{itemize}
\item {} 
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\DUrole{xref,std,std-ref}{modindex}

\item {} 
\DUrole{xref,std,std-ref}{search}

\end{itemize}



\renewcommand{\indexname}{Index}
\printindex
\end{document}
